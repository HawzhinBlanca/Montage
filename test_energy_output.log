/Users/hawzhin/.pyenv/versions/3.11.5/lib/python3.11/site-packages/transformers/utils/hub.py:111: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
2025-07-21 02:00:26,022 | INFO | src.config | ✅ OpenAI API key configured
2025-07-21 02:00:26,023 | INFO | src.config | ✅ Anthropic API key configured
2025-07-21 02:00:26,023 | INFO | src.config | ✅ Deepgram API key configured
2025-07-21 02:00:26,023 | INFO | src.config | ✅ Config loaded - MAX_COST_USD: $5.0
✅ DaVinci Resolve API available
✅ Connected to DaVinci Resolve
       Video Information       
┏━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Property    ┃ Value         ┃
┡━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ File        │ test_3min.mp4 │
│ Duration    │ 180.0 seconds │
│ Size        │ 6.2 MB        │
│ Resolution  │ 640x360       │
│ FPS         │ 24.0          │
│ Video Codec │ h264          │
│ Audio Codec │ aac           │
└─────────────┴───────────────┘

🚀 Starting MCP server...
Bottle v0.13.4 server starting up (using WSGIRefServer())...
Listening on http://localhost:7801/
Hit Ctrl-C to quit.

127.0.0.1 - - [21/Jul/2025 02:00:28] "GET /health HTTP/1.1" 200 20
🚀 Starting MCP bridge server on localhost:7801
   DaVinci Resolve: Available
   Endpoints: /buildTimeline, /renderProxy, /status, /health
✅ MCP server started successfully

🎬 Processing video in SMART mode
   Video: test_3min.mp4
📁 Output directory: /Users/hawzhin/Montage/output
2025-07-21 02:00:29,356 | INFO | faster_whisper | Processing audio with duration 03:00.001
2025-07-21 02:00:29,797 | INFO | faster_whisper | Detected language 'en' with probability 0.98
2025-07-21 02:01:09,294 | INFO | src.core.cost | API call to deepgram.nova-2: $0.0003 (total: $0.0003)
🎬 Analyzing video: test_3min.mp4
✅ Faster-whisper transcribed 365 words
📤 Direct Deepgram upload (180.0s)
❌ Deepgram failed: The write operation timed out
🔊 Using fallback speaker segmentation
🎤 Using simple VAD-based speaker segmentation...
✅ VAD segmentation found 2 speaker turns
✅ Video analysis complete: 365 words, 2 speaker turns
📝 Transcript: 365 words, 2 speaker turns
⠴ ✅ Video analysis complete
2025-07-21 02:01:10,865 | INFO | src.core.highlight_selector | 🎯 Starting REAL highlight analysis (no fake AI)
2025-07-21 02:01:10,865 | INFO | src.core.highlight_selector | 📊 Performing real local content scoring...
2025-07-21 02:01:10,865 | INFO | src.core.highlight_selector | ⚙️ Running real local rule-based scoring...
2025-07-21 02:01:10,866 | INFO | src.core.highlight_selector | ✅ Real local scoring generated 2 highlights
2025-07-21 02:01:10,866 | INFO | src.core.highlight_selector | ✅ Local scoring found 2 potential highlights
2025-07-21 02:01:10,866 | INFO | src.core.highlight_selector | 🧠 Enhancing with real Gemini AI analysis...
2025-07-21 02:01:15,588 | INFO | src.core.highlight_selector | ✅ Gemini story analysis complete: 3 narrative beats identified
2025-07-21 02:01:15,588 | INFO | src.core.cost | API call to gemini.2-5-flash: $0.00001 (total: $0.00031)
2025-07-21 02:01:15,588 | INFO | src.core.highlight_selector | ✅ Gemini generated 3 story-based highlights
2025-07-21 02:01:15,589 | INFO | src.core.highlight_selector | 🔗 Combined into 5 final highlights
🔧 Converted 365 words to 81 segments
⠼ ✅ Highlights selected
🎯 Selected 5 highlights (Cost: $0.000)
✅ Created subtitle file: /Users/hawzhin/Montage/output/subtitles/subtitle_1.srt (3 lines)
✅ Created subtitle file: /Users/hawzhin/Montage/output/subtitles/subtitle_2.srt (3 lines)
✅ Created subtitle file: /Users/hawzhin/Montage/output/subtitles/subtitle_3.srt (3 lines)
✅ Created subtitle file: /Users/hawzhin/Montage/output/subtitles/subtitle_4.srt (3 lines)
✅ Created subtitle file: /Users/hawzhin/Montage/output/subtitles/subtitle_5.srt (4 lines)
📄 Created 5 subtitle files
⠋ ✅ Subtitles created
✅ DaVinci timeline created
🎬 Starting DaVinci Resolve render: /Users/hawzhin/Montage/output/Montage_1753052475_timeline.mp4
...127.0.0.1 - - [21/Jul/2025 02:01:23] "POST /buildTimeline HTTP/1.1" 200 236

✅ DaVinci Resolve render complete
✅ Moved Montage_1753052475_timeline.mov to Montage_1753052475_timeline.mp4
🎬 Timeline created: davinci_resolve_rendered
⠹ ✅ Timeline built

✅ Pipeline Completed Successfully!

🎥 Output video created: 
/Users/hawzhin/Montage/output/Montage_1753052475_timeline.mp4
   Size: 77.21 MB

📊 Analysis Summary:
   • Words transcribed: 365
   • Speaker turns: 2
   • Transcript length: 2437 characters

🎯 Highlights Summary:
   • Mode: SMART
   • Clips selected: 5
   • Total cost: $0.000
                            Top Highlights                            
┏━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━┓
┃ Clip ┃ Title                                    ┃ Duration ┃ Score ┃
┡━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━┩
│ 1    │ a well -renowned geneticist, and cert... │ 10.4s    │ 10.0  │
│ 2    │ planet. My co -host is Honorable         │ 11.2s    │ 10.0  │
│ 3    │ of Australia, and again, in my           │ 10.0s    │ 10.0  │
│ 4    │ It's something that is causing hundre... │ 13.1s    │ 8.4   │
│ 5    │ And David, in terms of changing          │ 15.4s    │ 6.5   │
└──────┴──────────────────────────────────────────┴──────────┴───────┘

🎬 Timeline Summary:
   • Method: davinci_resolve_rendered
   • Clips added: 5
   • Output: /Users/hawzhin/Montage/output/Montage_1753052475_timeline.mp4

💾 Full plan saved to: montage_plan_1753052483.json
